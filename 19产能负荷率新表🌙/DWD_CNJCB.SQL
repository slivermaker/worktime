

TRUNCATE TABLE MDDWD.DWD_CNJCB;

INSERT INTO MDDWD.DWD_CNJCB(

  PRODUCTION_LINE , 
  CAPACITY_TYPE , 
  WORKING_DAYS , 
  MONTHLY_CAPACITY , 
  UNIT , 
  MIN_CAPACITY_RATE , 
  MIN_CAPACITY_T , 

)

SELECT 
   SCX
   , CNLX
   , SCTS
   , SUM(YCN) AS MONTHLY_CAPACITY
   , JLDW
   ,  TO_NUMBER(REPLACE( ZDCNFHL ,'%',''))/100 AS MIN_CAPACITY_RATE
   , SUM(ZDCNDW) AS MIN_CAPACITY_T

FROM ODS_ERP.ODS_CNJCB

GROUP BY SCX,CNLX,SCTS,JLDW,TO_NUMBER(REPLACE( ZDCNFHL ,'%',''))/100;