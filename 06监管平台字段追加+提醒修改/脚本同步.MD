需要更改的表名
~~~SQL
DWD_R250521002_J01                        'DWD_R250521002_J01',
DWD_R250412002_J01                        'DWD_R250412002_J01',
DWD_R250417001_J01                        'DWD_R250417001_J01',
DWD_R250417001_J03                        'DWD_R250417001_J03',
DWD_R250417001_J03                        'DWD_R250417001_J03',
DWD_R250417003_J01                        'DWD_R250417003_J01',
DWD_R250425001_J01                        'DWD_R250425001_J01',
DWD_R250425001_J02                        'DWD_R250425001_J02',
DWD_R250425001_J03                        'DWD_R250425001_J03',
DWD_R250425001_J04                        'DWD_R250425001_J04',
DWD_R250425002_J01                        'DWD_R250425002_J01',
DWD_R250425003_J01                        'DWD_R250425003_J01',
DWD_R250425003_J02                        'DWD_R250425003_J02',
DWD_R250425003_J03                        'DWD_R250425003_J03',
DWD_R250425003_J04                        'DWD_R250425003_J04',
DWD_R250425004_J01                        'DWD_R250425004_J01',
DWD_R250425004_J02                        'DWD_R250425004_J02',
DWD_R250425004_J03                        'DWD_R250425004_J03',
DWD_R250425004_J04                        'DWD_R250425004_J04',
DWD_R250425005_J01                        'DWD_R250425005_J01',
DWD_R050418001_J01                        'DWD_R050418001_J01',
DWD_R250417002_J01                        'DWD_R250417002_J01',
DWD_R250417002_J02                        'DWD_R250417002_J02',
DWD_R250417002_J03                        'DWD_R250417002_J03',
DWD_R250421001_J01                        'DWD_R250421001_J01',
DWD_R250421002_J01                        'DWD_R250421002_J01',
DWD_R250417004_J02                        'DWD_R250417004_J02',
DWD_R250417004_J01                        'DWD_R250417004_J01',
DWD_R250417005_J01                        'DWD_R250417005_J01',
DWD_R250512001_J01                        'DWD_R250512001_J01',
DWD_R250507001_J01                        'DWD_R250507001_J01',
DWD_R250514001_J01                        'DWD_R250514001_J01',
DWD_R250514001_J02                        'DWD_R250514001_J02',
DWD_R250521001_J01                        'DWD_R250521001_J01',
DWD_R250521003_J01                        'DWD_R250521003_J01',
DWD_R250521004_J01                        'DWD_R250521004_J01',
DWD_R250521004_J02                        'DWD_R250521004_J02',
DWD_R250604001_J01                        'DWD_R250604001_J01',
DWD_R250604001_J02                        'DWD_R250604001_J02',
DWD_R250604001_J03                        'DWD_R250604001_J03'

DWD_R250521002_J01
~~~



~~~sql
-- 1. DWD_R250521002_J01
ALTER TABLE DWD_R250521002_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250521002_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 2. DWD_R250412002_J01
ALTER TABLE DWD_R250412002_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250412002_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 3. DWD_R250417001_J01
ALTER TABLE DWD_R250417001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 4. DWD_R250417001_J03
ALTER TABLE DWD_R250417001_J03 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417001_J03.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 5. DWD_R250417003_J01
ALTER TABLE DWD_R250417003_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417003_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 6. DWD_R250425001_J01
ALTER TABLE DWD_R250425001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 7. DWD_R250425001_J02
ALTER TABLE DWD_R250425001_J02 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425001_J02.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 8. DWD_R250425001_J03
ALTER TABLE DWD_R250425001_J03 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425001_J03.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 9. DWD_R250425001_J04
ALTER TABLE DWD_R250425001_J04 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425001_J04.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 10. DWD_R250425002_J01
ALTER TABLE DWD_R250425002_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425002_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 11. DWD_R250425003_J01
ALTER TABLE DWD_R250425003_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425003_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 12. DWD_R250425003_J02
ALTER TABLE DWD_R250425003_J02 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425003_J02.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 13. DWD_R250425003_J03
ALTER TABLE DWD_R250425003_J03 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425003_J03.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 14. DWD_R250425003_J04
ALTER TABLE DWD_R250425003_J04 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425003_J04.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 15. DWD_R250425004_J01
ALTER TABLE DWD_R250425004_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425004_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 16. DWD_R250425004_J02
ALTER TABLE DWD_R250425004_J02 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425004_J02.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 17. DWD_R250425004_J03
ALTER TABLE DWD_R250425004_J03 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425004_J03.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 18. DWD_R250425004_J04
ALTER TABLE DWD_R250425004_J04 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425004_J04.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 19. DWD_R250425005_J01
ALTER TABLE DWD_R250425005_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250425005_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 20. DWD_R050418001_J01
ALTER TABLE DWD_R050418001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R050418001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 21. DWD_R250417002_J01
ALTER TABLE DWD_R250417002_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417002_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 22. DWD_R250417002_J02
ALTER TABLE DWD_R250417002_J02 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417002_J02.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 23. DWD_R250417002_J03
ALTER TABLE DWD_R250417002_J03 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417002_J03.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 24. DWD_R250421001_J01
ALTER TABLE DWD_R250421001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250421001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 25. DWD_R250421002_J01
ALTER TABLE DWD_R250421002_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250421002_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 26. DWD_R250417004_J02
ALTER TABLE DWD_R250417004_J02 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417004_J02.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 27. DWD_R250417004_J01
ALTER TABLE DWD_R250417004_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417004_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 28. DWD_R250417005_J01
ALTER TABLE DWD_R250417005_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417005_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 29. DWD_R250512001_J01
ALTER TABLE DWD_R250512001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250512001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 30. DWD_R250507001_J01
ALTER TABLE DWD_R250507001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250507001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 31. DWD_R250514001_J01
ALTER TABLE DWD_R250514001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250514001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 32. DWD_R250514001_J02
ALTER TABLE DWD_R250514001_J02 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250514001_J02.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 33. DWD_R250521001_J01
ALTER TABLE DWD_R250521001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250521001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 34. DWD_R250521003_J01
ALTER TABLE DWD_R250521003_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250521003_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 35. DWD_R250521004_J01
ALTER TABLE DWD_R250521004_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250521004_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 36. DWD_R250521004_J02
ALTER TABLE DWD_R250521004_J02 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250521004_J02.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 37. DWD_R250604001_J01
ALTER TABLE DWD_R250604001_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250604001_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 38. DWD_R250604001_J02
ALTER TABLE DWD_R250604001_J02 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250604001_J02.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 39. DWD_R250604001_J03
ALTER TABLE DWD_R250604001_J03 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250604001_J03.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 40 DWD_R250417001_J03
ALTER TABLE DWD_R250417001_J03 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250417001_J03.IS_WORKDAY IS '是否为工作日（1=是，0=否）';

-- 41. DWD_R250521002_J01
ALTER TABLE DWD_R250521002_J01 ADD IS_WORKDAY NUMBER DEFAULT 1;
COMMENT ON COLUMN DWD_R250521002_J01.IS_WORKDAY IS '是否为工作日（1=是，0=否）';
~~




~~~sql
BEGIN
  DECLARE
    v_success_count NUMBER := 0;
    v_error_count NUMBER := 0;
    v_total_count NUMBER := 0;
  BEGIN
    
    FOR r_table IN (
      SELECT 'DWD' || JOB_CODE AS table_name
      FROM dwd_data_check_job
      WHERE JOB_CODE IS NOT NULL
    ) LOOP
      v_total_count := v_total_count + 1;
      BEGIN
        EXECUTE IMMEDIATE '
          MERGE INTO ' || r_table.table_name || ' t
          USING (
            SELECT PERIOD_DATE, IS_WORKDAY 
            FROM DIM_DAY_D 
            WHERE PERIOD_DATE BETWEEN TO_DATE(''20250601'',''YYYYMMDD'') 
                                  AND TO_DATE(''20251231'',''YYYYMMDD'')
          ) d
          ON (TRUNC(t.CHECK_TIME) = d.PERIOD_DATE)
          WHEN MATCHED THEN
            UPDATE SET t.IS_WORKDAY = d.IS_WORKDAY';

        v_success_count := v_success_count + 1;
        DBMS_OUTPUT.PUT_LINE('成功更新: ' || r_table.table_name || ' - 影响行数: ' || SQL%ROWCOUNT);
        
        COMMIT;
      EXCEPTION
        WHEN OTHERS THEN
          ROLLBACK;
          v_error_count := v_error_count + 1;
          DBMS_OUTPUT.PUT_LINE('更新失败: ' || r_table.table_name || ' - ' || SUBSTR(SQLERRM, 1, 200));
      END;
    END LOOP;
    
    DBMS_OUTPUT.PUT_LINE('-------------------------------------------');
    DBMS_OUTPUT.PUT_LINE('批量更新完成');
    DBMS_OUTPUT.PUT_LINE('总表数: ' || v_total_count);
    DBMS_OUTPUT.PUT_LINE('成功: ' || v_success_count);
    DBMS_OUTPUT.PUT_LINE('失败: ' || v_error_count);
  END;
EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE('程序执行失败: ' || SQLERRM);
    ROLLBACK;
END;
~~~