TF_DWD_SALE_DLY_0519TMP

CREATE TABLE TF_DWD_SALE_DLY_0519TMP AS(
    SELECT * FROM TF_DWD_SALE_DLY WHERE ROWNUM=0
);
SELECT COUNT(1) FROM TF_DWD_SALE_DLY_0519TMP;



SELECT COMPANY_SN,PERIOD,COUNT(1) FROM TF_DWD_SALE_DLY WHERE PERIOD BETWEEN TO_DATE(20240201,'YYMMDD') AND TO_DATE(20241101,'YYMMDD')
GROUP BY COMPANY_SN,PERIOD ORDER BY COMPANY_SN,PERIOD;

SELECT MAX(PERIOD),MIN(PERIOD) FROM TF_DWD_SALE_DALY_0519_TMP ;


SELECT COMPANY_SN, PERIOD, COUNT(1) AS CNT
FROM TF_DWD_SALE_DLY
WHERE
    PERIOD < TO_DATE  (20241201, 'YYMMDD')
    AND COMPANY_SN IN ('玫德艾瓦兹')
GROUP BY
    COMPANY_SN,
    PERIOD
ORDER BY COMPANY_SN, PERIOD, CNT;

-------------------------------------------------------------------------------------------------------

SELECT COMPANY_SN, PERIOD, COUNT(1)
FROM DWD_SALE_DLY2_TMP
GROUP BY
    COMPANY_SN,
    PERIOD 

MINUS

SELECT COMPANY_SN, PERIOD, COUNT(1)
FROM DWD_SALE_DLY
WHERE
    COMPANY_SN IN ('玫德艾瓦兹')
    AND PERIOD < TO_DATE (20241201, 'YYMMDD')
GROUP BY
    COMPANY_SN,
    PERIOD